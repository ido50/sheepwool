/*	$Id$ */
/*
 * Copyright (c) 2022 Ido Perlmuter <sheepwool@ido50.net>
 *
 * Permission to use, copy, modify, and distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */
#include "config.h"

#include <curl/curl.h>
#include <errno.h>
#include <lauxlib.h>
#include <lua.h>
#include <magic.h>
#include <sqlite3.h>
#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/wait.h>
#include <syslog.h>
#include <unistd.h>

#if HAVE_B64_NTOP
#include <netinet/in.h>
#include <resolv.h>
#endif

#include "database.h"
#include "lua_registry.h"

// The etlua variable was automatically generated from the original etlua.lua
// file of https://github.com/leafo/etlua, by using the xd program:
// $ xd -detlua etlua.lua >> lua_registry.c
// elua is licensed under the MIT license.
// Copyright (C) 2014 by Leaf Corcoran
unsigned char etlua[] = {
    108, 111, 99,  97,  108, 32,  86,  69,  82,  83,  73,  79,  78,  32,  61,
    32,  34,  49,  46,  51,  46,  48,  34,  10,  108, 111, 99,  97,  108, 32,
    105, 110, 115, 101, 114, 116, 44,  32,  99,  111, 110, 99,  97,  116, 10,
    100, 111, 10,  32,  32,  108, 111, 99,  97,  108, 32,  95,  111, 98,  106,
    95,  48,  32,  61,  32,  116, 97,  98,  108, 101, 10,  32,  32,  105, 110,
    115, 101, 114, 116, 44,  32,  99,  111, 110, 99,  97,  116, 32,  61,  32,
    95,  111, 98,  106, 95,  48,  46,  105, 110, 115, 101, 114, 116, 44,  32,
    95,  111, 98,  106, 95,  48,  46,  99,  111, 110, 99,  97,  116, 10,  101,
    110, 100, 10,  108, 111, 99,  97,  108, 32,  108, 111, 97,  100, 44,  32,
    115, 101, 116, 102, 101, 110, 118, 44,  32,  97,  115, 115, 101, 114, 116,
    44,  32,  116, 121, 112, 101, 44,  32,  101, 114, 114, 111, 114, 44,  32,
    116, 111, 115, 116, 114, 105, 110, 103, 44,  32,  116, 111, 110, 117, 109,
    98,  101, 114, 44,  32,  115, 101, 116, 109, 101, 116, 97,  116, 97,  98,
    108, 101, 10,  100, 111, 10,  32,  32,  108, 111, 99,  97,  108, 32,  95,
    111, 98,  106, 95,  48,  32,  61,  32,  95,  71,  10,  32,  32,  108, 111,
    97,  100, 44,  32,  115, 101, 116, 102, 101, 110, 118, 44,  32,  97,  115,
    115, 101, 114, 116, 44,  32,  116, 121, 112, 101, 44,  32,  101, 114, 114,
    111, 114, 44,  32,  116, 111, 115, 116, 114, 105, 110, 103, 44,  32,  116,
    111, 110, 117, 109, 98,  101, 114, 44,  32,  115, 101, 116, 109, 101, 116,
    97,  116, 97,  98,  108, 101, 32,  61,  32,  95,  111, 98,  106, 95,  48,
    46,  108, 111, 97,  100, 44,  32,  95,  111, 98,  106, 95,  48,  46,  115,
    101, 116, 102, 101, 110, 118, 44,  32,  95,  111, 98,  106, 95,  48,  46,
    97,  115, 115, 101, 114, 116, 44,  32,  95,  111, 98,  106, 95,  48,  46,
    116, 121, 112, 101, 44,  32,  95,  111, 98,  106, 95,  48,  46,  101, 114,
    114, 111, 114, 44,  32,  95,  111, 98,  106, 95,  48,  46,  116, 111, 115,
    116, 114, 105, 110, 103, 44,  32,  95,  111, 98,  106, 95,  48,  46,  116,
    111, 110, 117, 109, 98,  101, 114, 44,  32,  95,  111, 98,  106, 95,  48,
    46,  115, 101, 116, 109, 101, 116, 97,  116, 97,  98,  108, 101, 10,  101,
    110, 100, 10,  115, 101, 116, 102, 101, 110, 118, 32,  61,  32,  115, 101,
    116, 102, 101, 110, 118, 32,  111, 114, 32,  102, 117, 110, 99,  116, 105,
    111, 110, 40,  102, 110, 44,  32,  101, 110, 118, 41,  10,  32,  32,  108,
    111, 99,  97,  108, 32,  110, 97,  109, 101, 10,  32,  32,  108, 111, 99,
    97,  108, 32,  105, 32,  61,  32,  49,  10,  32,  32,  119, 104, 105, 108,
    101, 32,  116, 114, 117, 101, 32,  100, 111, 10,  32,  32,  32,  32,  110,
    97,  109, 101, 32,  61,  32,  100, 101, 98,  117, 103, 46,  103, 101, 116,
    117, 112, 118, 97,  108, 117, 101, 40,  102, 110, 44,  32,  105, 41,  10,
    32,  32,  32,  32,  105, 102, 32,  110, 111, 116, 32,  110, 97,  109, 101,
    32,  111, 114, 32,  110, 97,  109, 101, 32,  61,  61,  32,  34,  95,  69,
    78,  86,  34,  32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,
    98,  114, 101, 97,  107, 10,  32,  32,  32,  32,  101, 110, 100, 10,  32,
    32,  32,  32,  105, 32,  61,  32,  105, 32,  43,  32,  49,  10,  32,  32,
    101, 110, 100, 10,  32,  32,  105, 102, 32,  110, 97,  109, 101, 32,  116,
    104, 101, 110, 10,  32,  32,  32,  32,  100, 101, 98,  117, 103, 46,  117,
    112, 118, 97,  108, 117, 101, 106, 111, 105, 110, 40,  102, 110, 44,  32,
    105, 44,  32,  40,  102, 117, 110, 99,  116, 105, 111, 110, 40,  41,  10,
    32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  101, 110,
    118, 10,  32,  32,  32,  32,  101, 110, 100, 41,  44,  32,  49,  41,  10,
    32,  32,  101, 110, 100, 10,  32,  32,  114, 101, 116, 117, 114, 110, 32,
    102, 110, 10,  101, 110, 100, 10,  108, 111, 99,  97,  108, 32,  104, 116,
    109, 108, 95,  101, 115, 99,  97,  112, 101, 95,  101, 110, 116, 105, 116,
    105, 101, 115, 32,  61,  32,  123, 10,  32,  32,  91,  39,  38,  39,  93,
    32,  61,  32,  39,  38,  97,  109, 112, 59,  39,  44,  10,  32,  32,  91,
    39,  60,  39,  93,  32,  61,  32,  39,  38,  108, 116, 59,  39,  44,  10,
    32,  32,  91,  39,  62,  39,  93,  32,  61,  32,  39,  38,  103, 116, 59,
    39,  44,  10,  32,  32,  91,  39,  34,  39,  93,  32,  61,  32,  39,  38,
    113, 117, 111, 116, 59,  39,  44,  10,  32,  32,  91,  34,  39,  34,  93,
    32,  61,  32,  39,  38,  35,  48,  51,  57,  59,  39,  10,  125, 10,  108,
    111, 99,  97,  108, 32,  104, 116, 109, 108, 95,  101, 115, 99,  97,  112,
    101, 10,  104, 116, 109, 108, 95,  101, 115, 99,  97,  112, 101, 32,  61,
    32,  102, 117, 110, 99,  116, 105, 111, 110, 40,  115, 116, 114, 41,  10,
    32,  32,  114, 101, 116, 117, 114, 110, 32,  40,  115, 116, 114, 58,  103,
    115, 117, 98,  40,  91,  61,  91,  91,  34,  62,  60,  39,  38,  93,  93,
    61,  93,  44,  32,  104, 116, 109, 108, 95,  101, 115, 99,  97,  112, 101,
    95,  101, 110, 116, 105, 116, 105, 101, 115, 41,  41,  10,  101, 110, 100,
    10,  108, 111, 99,  97,  108, 32,  103, 101, 116, 95,  108, 105, 110, 101,
    10,  103, 101, 116, 95,  108, 105, 110, 101, 32,  61,  32,  102, 117, 110,
    99,  116, 105, 111, 110, 40,  115, 116, 114, 44,  32,  108, 105, 110, 101,
    95,  110, 117, 109, 41,  10,  32,  32,  102, 111, 114, 32,  108, 105, 110,
    101, 32,  105, 110, 32,  115, 116, 114, 58,  103, 109, 97,  116, 99,  104,
    40,  34,  40,  91,  94,  92,  110, 93,  42,  41,  92,  110, 63,  34,  41,
    32,  100, 111, 10,  32,  32,  32,  32,  105, 102, 32,  108, 105, 110, 101,
    95,  110, 117, 109, 32,  61,  61,  32,  49,  32,  116, 104, 101, 110, 10,
    32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  108, 105,
    110, 101, 10,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,
    108, 105, 110, 101, 95,  110, 117, 109, 32,  61,  32,  108, 105, 110, 101,
    95,  110, 117, 109, 32,  45,  32,  49,  10,  32,  32,  101, 110, 100, 10,
    101, 110, 100, 10,  108, 111, 99,  97,  108, 32,  112, 111, 115, 95,  116,
    111, 95,  108, 105, 110, 101, 10,  112, 111, 115, 95,  116, 111, 95,  108,
    105, 110, 101, 32,  61,  32,  102, 117, 110, 99,  116, 105, 111, 110, 40,
    115, 116, 114, 44,  32,  112, 111, 115, 41,  10,  32,  32,  108, 111, 99,
    97,  108, 32,  108, 105, 110, 101, 32,  61,  32,  49,  10,  32,  32,  102,
    111, 114, 32,  95,  32,  105, 110, 32,  115, 116, 114, 58,  115, 117, 98,
    40,  49,  44,  32,  112, 111, 115, 41,  58,  103, 109, 97,  116, 99,  104,
    40,  34,  92,  110, 34,  41,  32,  100, 111, 10,  32,  32,  32,  32,  108,
    105, 110, 101, 32,  61,  32,  108, 105, 110, 101, 32,  43,  32,  49,  10,
    32,  32,  101, 110, 100, 10,  32,  32,  114, 101, 116, 117, 114, 110, 32,
    108, 105, 110, 101, 10,  101, 110, 100, 10,  108, 111, 99,  97,  108, 32,
    67,  111, 109, 112, 105, 108, 101, 114, 10,  100, 111, 10,  32,  32,  108,
    111, 99,  97,  108, 32,  95,  99,  108, 97,  115, 115, 95,  48,  10,  32,
    32,  108, 111, 99,  97,  108, 32,  95,  98,  97,  115, 101, 95,  48,  32,
    61,  32,  123, 10,  32,  32,  32,  32,  114, 101, 110, 100, 101, 114, 32,
    61,  32,  102, 117, 110, 99,  116, 105, 111, 110, 40,  115, 101, 108, 102,
    41,  10,  32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,
    116, 97,  98,  108, 101, 46,  99,  111, 110, 99,  97,  116, 40,  115, 101,
    108, 102, 46,  98,  117, 102, 102, 101, 114, 41,  10,  32,  32,  32,  32,
    101, 110, 100, 44,  10,  32,  32,  32,  32,  112, 117, 115, 104, 32,  61,
    32,  102, 117, 110, 99,  116, 105, 111, 110, 40,  115, 101, 108, 102, 44,
    32,  115, 116, 114, 44,  32,  46,  46,  46,  41,  10,  32,  32,  32,  32,
    32,  32,  108, 111, 99,  97,  108, 32,  105, 32,  61,  32,  115, 101, 108,
    102, 46,  105, 32,  43,  32,  49,  10,  32,  32,  32,  32,  32,  32,  115,
    101, 108, 102, 46,  98,  117, 102, 102, 101, 114, 91,  105, 93,  32,  61,
    32,  115, 116, 114, 10,  32,  32,  32,  32,  32,  32,  115, 101, 108, 102,
    46,  105, 32,  61,  32,  105, 10,  32,  32,  32,  32,  32,  32,  105, 102,
    32,  46,  46,  46,  32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  115, 101, 108, 102, 58,
    112, 117, 115, 104, 40,  46,  46,  46,  41,  10,  32,  32,  32,  32,  32,
    32,  101, 110, 100, 10,  32,  32,  32,  32,  101, 110, 100, 44,  10,  32,
    32,  32,  32,  104, 101, 97,  100, 101, 114, 32,  61,  32,  102, 117, 110,
    99,  116, 105, 111, 110, 40,  115, 101, 108, 102, 41,  10,  32,  32,  32,
    32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  115, 101, 108, 102, 58,
    112, 117, 115, 104, 40,  34,  108, 111, 99,  97,  108, 32,  95,  116, 111,
    115, 116, 114, 105, 110, 103, 44,  32,  95,  101, 115, 99,  97,  112, 101,
    44,  32,  95,  98,  44,  32,  95,  98,  95,  105, 32,  61,  32,  46,  46,
    46,  92,  110, 34,  41,  10,  32,  32,  32,  32,  101, 110, 100, 44,  10,
    32,  32,  32,  32,  102, 111, 111, 116, 101, 114, 32,  61,  32,  102, 117,
    110, 99,  116, 105, 111, 110, 40,  115, 101, 108, 102, 41,  10,  32,  32,
    32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  115, 101, 108, 102,
    58,  112, 117, 115, 104, 40,  34,  114, 101, 116, 117, 114, 110, 32,  95,
    98,  34,  41,  10,  32,  32,  32,  32,  101, 110, 100, 44,  10,  32,  32,
    32,  32,  105, 110, 99,  114, 101, 109, 101, 110, 116, 32,  61,  32,  102,
    117, 110, 99,  116, 105, 111, 110, 40,  115, 101, 108, 102, 41,  10,  32,
    32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  115, 101, 108,
    102, 58,  112, 117, 115, 104, 40,  34,  95,  98,  95,  105, 32,  61,  32,
    95,  98,  95,  105, 32,  43,  32,  49,  92,  110, 34,  41,  10,  32,  32,
    32,  32,  101, 110, 100, 44,  10,  32,  32,  32,  32,  109, 97,  114, 107,
    32,  61,  32,  102, 117, 110, 99,  116, 105, 111, 110, 40,  115, 101, 108,
    102, 44,  32,  112, 111, 115, 41,  10,  32,  32,  32,  32,  32,  32,  114,
    101, 116, 117, 114, 110, 32,  115, 101, 108, 102, 58,  112, 117, 115, 104,
    40,  34,  45,  45,  91,  91,  34,  44,  32,  116, 111, 115, 116, 114, 105,
    110, 103, 40,  112, 111, 115, 41,  44,  32,  34,  93,  93,  32,  34,  41,
    10,  32,  32,  32,  32,  101, 110, 100, 44,  10,  32,  32,  32,  32,  97,
    115, 115, 105, 103, 110, 32,  61,  32,  102, 117, 110, 99,  116, 105, 111,
    110, 40,  115, 101, 108, 102, 44,  32,  46,  46,  46,  41,  10,  32,  32,
    32,  32,  32,  32,  115, 101, 108, 102, 58,  112, 117, 115, 104, 40,  34,
    95,  98,  91,  95,  98,  95,  105, 93,  32,  61,  32,  34,  44,  32,  46,
    46,  46,  41,  10,  32,  32,  32,  32,  32,  32,  105, 102, 32,  46,  46,
    46,  32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,
    114, 101, 116, 117, 114, 110, 32,  115, 101, 108, 102, 58,  112, 117, 115,
    104, 40,  34,  92,  110, 34,  41,  10,  32,  32,  32,  32,  32,  32,  101,
    110, 100, 10,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  125, 10,
    32,  32,  95,  98,  97,  115, 101, 95,  48,  46,  95,  95,  105, 110, 100,
    101, 120, 32,  61,  32,  95,  98,  97,  115, 101, 95,  48,  10,  32,  32,
    95,  99,  108, 97,  115, 115, 95,  48,  32,  61,  32,  115, 101, 116, 109,
    101, 116, 97,  116, 97,  98,  108, 101, 40,  123, 10,  32,  32,  32,  32,
    95,  95,  105, 110, 105, 116, 32,  61,  32,  102, 117, 110, 99,  116, 105,
    111, 110, 40,  115, 101, 108, 102, 41,  10,  32,  32,  32,  32,  32,  32,
    115, 101, 108, 102, 46,  98,  117, 102, 102, 101, 114, 32,  61,  32,  123,
    32,  125, 10,  32,  32,  32,  32,  32,  32,  115, 101, 108, 102, 46,  105,
    32,  61,  32,  48,  10,  32,  32,  32,  32,  101, 110, 100, 44,  10,  32,
    32,  32,  32,  95,  95,  98,  97,  115, 101, 32,  61,  32,  95,  98,  97,
    115, 101, 95,  48,  44,  10,  32,  32,  32,  32,  95,  95,  110, 97,  109,
    101, 32,  61,  32,  34,  67,  111, 109, 112, 105, 108, 101, 114, 34,  10,
    32,  32,  125, 44,  32,  123, 10,  32,  32,  32,  32,  95,  95,  105, 110,
    100, 101, 120, 32,  61,  32,  95,  98,  97,  115, 101, 95,  48,  44,  10,
    32,  32,  32,  32,  95,  95,  99,  97,  108, 108, 32,  61,  32,  102, 117,
    110, 99,  116, 105, 111, 110, 40,  99,  108, 115, 44,  32,  46,  46,  46,
    41,  10,  32,  32,  32,  32,  32,  32,  108, 111, 99,  97,  108, 32,  95,
    115, 101, 108, 102, 95,  48,  32,  61,  32,  115, 101, 116, 109, 101, 116,
    97,  116, 97,  98,  108, 101, 40,  123, 125, 44,  32,  95,  98,  97,  115,
    101, 95,  48,  41,  10,  32,  32,  32,  32,  32,  32,  99,  108, 115, 46,
    95,  95,  105, 110, 105, 116, 40,  95,  115, 101, 108, 102, 95,  48,  44,
    32,  46,  46,  46,  41,  10,  32,  32,  32,  32,  32,  32,  114, 101, 116,
    117, 114, 110, 32,  95,  115, 101, 108, 102, 95,  48,  10,  32,  32,  32,
    32,  101, 110, 100, 10,  32,  32,  125, 41,  10,  32,  32,  95,  98,  97,
    115, 101, 95,  48,  46,  95,  95,  99,  108, 97,  115, 115, 32,  61,  32,
    95,  99,  108, 97,  115, 115, 95,  48,  10,  32,  32,  67,  111, 109, 112,
    105, 108, 101, 114, 32,  61,  32,  95,  99,  108, 97,  115, 115, 95,  48,
    10,  101, 110, 100, 10,  108, 111, 99,  97,  108, 32,  80,  97,  114, 115,
    101, 114, 10,  100, 111, 10,  32,  32,  108, 111, 99,  97,  108, 32,  95,
    99,  108, 97,  115, 115, 95,  48,  10,  32,  32,  108, 111, 99,  97,  108,
    32,  95,  98,  97,  115, 101, 95,  48,  32,  61,  32,  123, 10,  32,  32,
    32,  32,  111, 112, 101, 110, 95,  116, 97,  103, 32,  61,  32,  34,  60,
    37,  34,  44,  10,  32,  32,  32,  32,  99,  108, 111, 115, 101, 95,  116,
    97,  103, 32,  61,  32,  34,  37,  62,  34,  44,  10,  32,  32,  32,  32,
    109, 111, 100, 105, 102, 105, 101, 114, 115, 32,  61,  32,  34,  94,  91,
    61,  45,  93,  34,  44,  10,  32,  32,  32,  32,  104, 116, 109, 108, 95,
    101, 115, 99,  97,  112, 101, 32,  61,  32,  116, 114, 117, 101, 44,  10,
    32,  32,  32,  32,  110, 101, 120, 116, 95,  116, 97,  103, 32,  61,  32,
    102, 117, 110, 99,  116, 105, 111, 110, 40,  115, 101, 108, 102, 41,  10,
    32,  32,  32,  32,  32,  32,  108, 111, 99,  97,  108, 32,  115, 116, 97,
    114, 116, 44,  32,  115, 116, 111, 112, 32,  61,  32,  115, 101, 108, 102,
    46,  115, 116, 114, 58,  102, 105, 110, 100, 40,  115, 101, 108, 102, 46,
    111, 112, 101, 110, 95,  116, 97,  103, 44,  32,  115, 101, 108, 102, 46,
    112, 111, 115, 44,  32,  116, 114, 117, 101, 41,  10,  32,  32,  32,  32,
    32,  32,  105, 102, 32,  110, 111, 116, 32,  40,  115, 116, 97,  114, 116,
    41,  32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,
    115, 101, 108, 102, 58,  112, 117, 115, 104, 95,  114, 97,  119, 40,  115,
    101, 108, 102, 46,  112, 111, 115, 44,  32,  35,  115, 101, 108, 102, 46,
    115, 116, 114, 41,  10,  32,  32,  32,  32,  32,  32,  32,  32,  114, 101,
    116, 117, 114, 110, 32,  102, 97,  108, 115, 101, 10,  32,  32,  32,  32,
    32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  105, 102, 32,
    110, 111, 116, 32,  40,  115, 116, 97,  114, 116, 32,  61,  61,  32,  115,
    101, 108, 102, 46,  112, 111, 115, 41,  32,  116, 104, 101, 110, 10,  32,
    32,  32,  32,  32,  32,  32,  32,  115, 101, 108, 102, 58,  112, 117, 115,
    104, 95,  114, 97,  119, 40,  115, 101, 108, 102, 46,  112, 111, 115, 44,
    32,  115, 116, 97,  114, 116, 32,  45,  32,  49,  41,  10,  32,  32,  32,
    32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  115, 101,
    108, 102, 46,  112, 111, 115, 32,  61,  32,  115, 116, 111, 112, 32,  43,
    32,  49,  10,  32,  32,  32,  32,  32,  32,  108, 111, 99,  97,  108, 32,
    109, 111, 100, 105, 102, 105, 101, 114, 10,  32,  32,  32,  32,  32,  32,
    105, 102, 32,  115, 101, 108, 102, 46,  115, 116, 114, 58,  109, 97,  116,
    99,  104, 40,  115, 101, 108, 102, 46,  109, 111, 100, 105, 102, 105, 101,
    114, 115, 44,  32,  115, 101, 108, 102, 46,  112, 111, 115, 41,  32,  116,
    104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,  100, 111, 10,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  108, 111, 99,  97,  108,
    32,  95,  119, 105, 116, 104, 95,  48,  32,  61,  32,  115, 101, 108, 102,
    46,  115, 116, 114, 58,  115, 117, 98,  40,  115, 101, 108, 102, 46,  112,
    111, 115, 44,  32,  115, 101, 108, 102, 46,  112, 111, 115, 41,  10,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  115, 101, 108, 102, 46,  112,
    111, 115, 32,  61,  32,  115, 101, 108, 102, 46,  112, 111, 115, 32,  43,
    32,  49,  10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  109, 111,
    100, 105, 102, 105, 101, 114, 32,  61,  32,  95,  119, 105, 116, 104, 95,
    48,  10,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,
    32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,
    108, 111, 99,  97,  108, 32,  99,  108, 111, 115, 101, 95,  115, 116, 97,
    114, 116, 44,  32,  99,  108, 111, 115, 101, 95,  115, 116, 111, 112, 32,
    61,  32,  115, 101, 108, 102, 46,  115, 116, 114, 58,  102, 105, 110, 100,
    40,  115, 101, 108, 102, 46,  99,  108, 111, 115, 101, 95,  116, 97,  103,
    44,  32,  115, 101, 108, 102, 46,  112, 111, 115, 44,  32,  116, 114, 117,
    101, 41,  10,  32,  32,  32,  32,  32,  32,  105, 102, 32,  110, 111, 116,
    32,  40,  99,  108, 111, 115, 101, 95,  115, 116, 97,  114, 116, 41,  32,
    116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,  114, 101,
    116, 117, 114, 110, 32,  110, 105, 108, 44,  32,  115, 101, 108, 102, 58,
    101, 114, 114, 111, 114, 95,  102, 111, 114, 95,  112, 111, 115, 40,  115,
    116, 97,  114, 116, 44,  32,  34,  102, 97,  105, 108, 101, 100, 32,  116,
    111, 32,  102, 105, 110, 100, 32,  99,  108, 111, 115, 105, 110, 103, 32,
    116, 97,  103, 34,  41,  10,  32,  32,  32,  32,  32,  32,  101, 110, 100,
    10,  32,  32,  32,  32,  32,  32,  119, 104, 105, 108, 101, 32,  115, 101,
    108, 102, 58,  105, 110, 95,  115, 116, 114, 105, 110, 103, 40,  115, 101,
    108, 102, 46,  112, 111, 115, 44,  32,  99,  108, 111, 115, 101, 95,  115,
    116, 97,  114, 116, 41,  32,  100, 111, 10,  32,  32,  32,  32,  32,  32,
    32,  32,  99,  108, 111, 115, 101, 95,  115, 116, 97,  114, 116, 44,  32,
    99,  108, 111, 115, 101, 95,  115, 116, 111, 112, 32,  61,  32,  115, 101,
    108, 102, 46,  115, 116, 114, 58,  102, 105, 110, 100, 40,  115, 101, 108,
    102, 46,  99,  108, 111, 115, 101, 95,  116, 97,  103, 44,  32,  99,  108,
    111, 115, 101, 95,  115, 116, 111, 112, 44,  32,  116, 114, 117, 101, 41,
    10,  32,  32,  32,  32,  32,  32,  32,  32,  105, 102, 32,  110, 111, 116,
    32,  40,  99,  108, 111, 115, 101, 95,  115, 116, 97,  114, 116, 41,  32,
    116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    114, 101, 116, 117, 114, 110, 32,  110, 105, 108, 44,  32,  115, 101, 108,
    102, 58,  101, 114, 114, 111, 114, 95,  102, 111, 114, 95,  112, 111, 115,
    40,  115, 116, 97,  114, 116, 44,  32,  34,  102, 97,  105, 108, 101, 100,
    32,  116, 111, 32,  102, 105, 110, 100, 32,  115, 116, 114, 105, 110, 103,
    32,  99,  108, 111, 115, 101, 34,  41,  10,  32,  32,  32,  32,  32,  32,
    32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  101, 110, 100,
    10,  32,  32,  32,  32,  32,  32,  108, 111, 99,  97,  108, 32,  116, 114,
    105, 109, 95,  110, 101, 119, 108, 105, 110, 101, 10,  32,  32,  32,  32,
    32,  32,  105, 102, 32,  34,  45,  34,  32,  61,  61,  32,  115, 101, 108,
    102, 46,  115, 116, 114, 58,  115, 117, 98,  40,  99,  108, 111, 115, 101,
    95,  115, 116, 97,  114, 116, 32,  45,  32,  49,  44,  32,  99,  108, 111,
    115, 101, 95,  115, 116, 97,  114, 116, 32,  45,  32,  49,  41,  32,  116,
    104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,  99,  108, 111,
    115, 101, 95,  115, 116, 97,  114, 116, 32,  61,  32,  99,  108, 111, 115,
    101, 95,  115, 116, 97,  114, 116, 32,  45,  32,  49,  10,  32,  32,  32,
    32,  32,  32,  32,  32,  116, 114, 105, 109, 95,  110, 101, 119, 108, 105,
    110, 101, 32,  61,  32,  116, 114, 117, 101, 10,  32,  32,  32,  32,  32,
    32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  115, 101, 108, 102,
    58,  112, 117, 115, 104, 95,  99,  111, 100, 101, 40,  109, 111, 100, 105,
    102, 105, 101, 114, 32,  111, 114, 32,  34,  99,  111, 100, 101, 34,  44,
    32,  115, 101, 108, 102, 46,  112, 111, 115, 44,  32,  99,  108, 111, 115,
    101, 95,  115, 116, 97,  114, 116, 32,  45,  32,  49,  41,  10,  32,  32,
    32,  32,  32,  32,  115, 101, 108, 102, 46,  112, 111, 115, 32,  61,  32,
    99,  108, 111, 115, 101, 95,  115, 116, 111, 112, 32,  43,  32,  49,  10,
    32,  32,  32,  32,  32,  32,  105, 102, 32,  116, 114, 105, 109, 95,  110,
    101, 119, 108, 105, 110, 101, 32,  116, 104, 101, 110, 10,  32,  32,  32,
    32,  32,  32,  32,  32,  100, 111, 10,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  108, 111, 99,  97,  108, 32,  109, 97,  116, 99,  104, 32,
    61,  32,  115, 101, 108, 102, 46,  115, 116, 114, 58,  109, 97,  116, 99,
    104, 40,  34,  94,  92,  110, 34,  44,  32,  115, 101, 108, 102, 46,  112,
    111, 115, 41,  10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  105,
    102, 32,  109, 97,  116, 99,  104, 32,  116, 104, 101, 110, 10,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  115, 101, 108, 102, 46,
    112, 111, 115, 32,  61,  32,  115, 101, 108, 102, 46,  112, 111, 115, 32,
    43,  32,  35,  109, 97,  116, 99,  104, 10,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  32,
    32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,
    32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  116, 114,
    117, 101, 10,  32,  32,  32,  32,  101, 110, 100, 44,  10,  32,  32,  32,
    32,  105, 110, 95,  115, 116, 114, 105, 110, 103, 32,  61,  32,  102, 117,
    110, 99,  116, 105, 111, 110, 40,  115, 101, 108, 102, 44,  32,  115, 116,
    97,  114, 116, 44,  32,  115, 116, 111, 112, 41,  10,  32,  32,  32,  32,
    32,  32,  108, 111, 99,  97,  108, 32,  105, 110, 95,  115, 116, 114, 105,
    110, 103, 32,  61,  32,  102, 97,  108, 115, 101, 10,  32,  32,  32,  32,
    32,  32,  108, 111, 99,  97,  108, 32,  101, 110, 100, 95,  100, 101, 108,
    105, 109, 32,  61,  32,  110, 105, 108, 10,  32,  32,  32,  32,  32,  32,
    108, 111, 99,  97,  108, 32,  101, 115, 99,  97,  112, 101, 32,  61,  32,
    102, 97,  108, 115, 101, 10,  32,  32,  32,  32,  32,  32,  108, 111, 99,
    97,  108, 32,  112, 111, 115, 32,  61,  32,  48,  10,  32,  32,  32,  32,
    32,  32,  108, 111, 99,  97,  108, 32,  115, 107, 105, 112, 95,  117, 110,
    116, 105, 108, 32,  61,  32,  110, 105, 108, 10,  32,  32,  32,  32,  32,
    32,  108, 111, 99,  97,  108, 32,  99,  104, 117, 110, 107, 32,  61,  32,
    115, 101, 108, 102, 46,  115, 116, 114, 58,  115, 117, 98,  40,  115, 116,
    97,  114, 116, 44,  32,  115, 116, 111, 112, 41,  10,  32,  32,  32,  32,
    32,  32,  102, 111, 114, 32,  99,  104, 97,  114, 32,  105, 110, 32,  99,
    104, 117, 110, 107, 58,  103, 109, 97,  116, 99,  104, 40,  34,  46,  34,
    41,  32,  100, 111, 10,  32,  32,  32,  32,  32,  32,  32,  32,  108, 111,
    99,  97,  108, 32,  95,  99,  111, 110, 116, 105, 110, 117, 101, 95,  48,
    32,  61,  32,  102, 97,  108, 115, 101, 10,  32,  32,  32,  32,  32,  32,
    32,  32,  114, 101, 112, 101, 97,  116, 10,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  112, 111, 115, 32,  61,  32,  112, 111, 115, 32,  43,
    32,  49,  10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  105, 102,
    32,  115, 107, 105, 112, 95,  117, 110, 116, 105, 108, 32,  116, 104, 101,
    110, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  105,
    102, 32,  112, 111, 115, 32,  60,  61,  32,  115, 107, 105, 112, 95,  117,
    110, 116, 105, 108, 32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  95,  99,  111, 110, 116, 105,
    110, 117, 101, 95,  48,  32,  61,  32,  116, 114, 117, 101, 10,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  98,  114, 101,
    97,  107, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  115, 107, 105, 112, 95,  117, 110, 116, 105, 108, 32,  61,  32,  110,
    105, 108, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110,
    100, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  105, 102, 32,
    101, 110, 100, 95,  100, 101, 108, 105, 109, 32,  116, 104, 101, 110, 10,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  105, 102, 32,
    101, 110, 100, 95,  100, 101, 108, 105, 109, 32,  61,  61,  32,  99,  104,
    97,  114, 32,  97,  110, 100, 32,  110, 111, 116, 32,  101, 115, 99,  97,
    112, 101, 32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  105, 110, 95,  115, 116, 114, 105, 110,
    103, 32,  61,  32,  102, 97,  108, 115, 101, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100, 95,  100, 101,
    108, 105, 109, 32,  61,  32,  110, 105, 108, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  101, 108, 115, 101, 10,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  105, 102, 32,  99,  104, 97,  114,
    32,  61,  61,  32,  34,  39,  34,  32,  111, 114, 32,  99,  104, 97,  114,
    32,  61,  61,  32,  39,  34,  39,  32,  116, 104, 101, 110, 10,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100,
    95,  100, 101, 108, 105, 109, 32,  61,  32,  99,  104, 97,  114, 10,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  105, 110,
    95,  115, 116, 114, 105, 110, 103, 32,  61,  32,  116, 114, 117, 101, 10,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100,
    10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  105, 102,
    32,  99,  104, 97,  114, 32,  61,  61,  32,  34,  91,  34,  32,  116, 104,
    101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  100, 111, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  108, 111, 99,  97,  108, 32,  108, 115, 116,
    114, 105, 110, 103, 32,  61,  32,  99,  104, 117, 110, 107, 58,  109, 97,
    116, 99,  104, 40,  34,  94,  37,  91,  61,  42,  37,  91,  34,  44,  32,
    112, 111, 115, 41,  10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  105, 102, 32,  108, 115, 116, 114, 105, 110,
    103, 32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  108, 111, 99,  97,  108,
    32,  108, 115, 116, 114, 105, 110, 103, 95,  101, 110, 100, 32,  61,  32,
    108, 115, 116, 114, 105, 110, 103, 58,  103, 115, 117, 98,  40,  34,  37,
    91,  34,  44,  32,  34,  93,  34,  41,  10,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  108, 111, 99,
    97,  108, 32,  108, 115, 116, 114, 105, 110, 103, 95,  112, 49,  44,  32,
    108, 115, 116, 114, 105, 110, 103, 95,  112, 50,  32,  61,  32,  99,  104,
    117, 110, 107, 58,  102, 105, 110, 100, 40,  108, 115, 116, 114, 105, 110,
    103, 95,  101, 110, 100, 44,  32,  112, 111, 115, 44,  32,  116, 114, 117,
    101, 41,  10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  105, 102, 32,  110, 111, 116, 32,  40,  108,
    115, 116, 114, 105, 110, 103, 95,  112, 49,  41,  32,  116, 104, 101, 110,
    10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  116, 114,
    117, 101, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  115, 107,
    105, 112, 95,  117, 110, 116, 105, 108, 32,  61,  32,  108, 115, 116, 114,
    105, 110, 103, 95,  112, 50,  10,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100,
    10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  101, 115, 99,  97,  112,
    101, 32,  61,  32,  99,  104, 97,  114, 32,  61,  61,  32,  34,  92,  92,
    34,  10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  95,  99,  111,
    110, 116, 105, 110, 117, 101, 95,  48,  32,  61,  32,  116, 114, 117, 101,
    10,  32,  32,  32,  32,  32,  32,  32,  32,  117, 110, 116, 105, 108, 32,
    116, 114, 117, 101, 10,  32,  32,  32,  32,  32,  32,  32,  32,  105, 102,
    32,  110, 111, 116, 32,  95,  99,  111, 110, 116, 105, 110, 117, 101, 95,
    48,  32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  98,  114, 101, 97,  107, 10,  32,  32,  32,  32,  32,  32,  32,
    32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,
    32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  105, 110,
    95,  115, 116, 114, 105, 110, 103, 10,  32,  32,  32,  32,  101, 110, 100,
    44,  10,  32,  32,  32,  32,  112, 117, 115, 104, 95,  114, 97,  119, 32,
    61,  32,  102, 117, 110, 99,  116, 105, 111, 110, 40,  115, 101, 108, 102,
    44,  32,  115, 116, 97,  114, 116, 44,  32,  115, 116, 111, 112, 41,  10,
    32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  105, 110,
    115, 101, 114, 116, 40,  115, 101, 108, 102, 46,  99,  104, 117, 110, 107,
    115, 44,  32,  115, 101, 108, 102, 46,  115, 116, 114, 58,  115, 117, 98,
    40,  115, 116, 97,  114, 116, 44,  32,  115, 116, 111, 112, 41,  41,  10,
    32,  32,  32,  32,  101, 110, 100, 44,  10,  32,  32,  32,  32,  112, 117,
    115, 104, 95,  99,  111, 100, 101, 32,  61,  32,  102, 117, 110, 99,  116,
    105, 111, 110, 40,  115, 101, 108, 102, 44,  32,  107, 105, 110, 100, 44,
    32,  115, 116, 97,  114, 116, 44,  32,  115, 116, 111, 112, 41,  10,  32,
    32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  105, 110, 115,
    101, 114, 116, 40,  115, 101, 108, 102, 46,  99,  104, 117, 110, 107, 115,
    44,  32,  123, 10,  32,  32,  32,  32,  32,  32,  32,  32,  107, 105, 110,
    100, 44,  10,  32,  32,  32,  32,  32,  32,  32,  32,  115, 101, 108, 102,
    46,  115, 116, 114, 58,  115, 117, 98,  40,  115, 116, 97,  114, 116, 44,
    32,  115, 116, 111, 112, 41,  44,  10,  32,  32,  32,  32,  32,  32,  32,
    32,  115, 116, 97,  114, 116, 10,  32,  32,  32,  32,  32,  32,  125, 41,
    10,  32,  32,  32,  32,  101, 110, 100, 44,  10,  32,  32,  32,  32,  99,
    111, 109, 112, 105, 108, 101, 32,  61,  32,  102, 117, 110, 99,  116, 105,
    111, 110, 40,  115, 101, 108, 102, 44,  32,  115, 116, 114, 41,  10,  32,
    32,  32,  32,  32,  32,  108, 111, 99,  97,  108, 32,  115, 117, 99,  99,
    101, 115, 115, 44,  32,  101, 114, 114, 32,  61,  32,  115, 101, 108, 102,
    58,  112, 97,  114, 115, 101, 40,  115, 116, 114, 41,  10,  32,  32,  32,
    32,  32,  32,  105, 102, 32,  110, 111, 116, 32,  40,  115, 117, 99,  99,
    101, 115, 115, 41,  32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  110, 105, 108, 44,  32,
    101, 114, 114, 10,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,
    32,  32,  32,  32,  32,  108, 111, 99,  97,  108, 32,  102, 110, 10,  32,
    32,  32,  32,  32,  32,  102, 110, 44,  32,  101, 114, 114, 32,  61,  32,
    115, 101, 108, 102, 58,  108, 111, 97,  100, 40,  115, 101, 108, 102, 58,
    99,  104, 117, 110, 107, 115, 95,  116, 111, 95,  108, 117, 97,  40,  41,
    41,  10,  32,  32,  32,  32,  32,  32,  105, 102, 32,  110, 111, 116, 32,
    40,  102, 110, 41,  32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  110, 105, 108, 44,  32,
    101, 114, 114, 10,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,
    32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  102, 117, 110,
    99,  116, 105, 111, 110, 40,  46,  46,  46,  41,  10,  32,  32,  32,  32,
    32,  32,  32,  32,  108, 111, 99,  97,  108, 32,  98,  117, 102, 102, 101,
    114, 10,  32,  32,  32,  32,  32,  32,  32,  32,  98,  117, 102, 102, 101,
    114, 44,  32,  101, 114, 114, 32,  61,  32,  115, 101, 108, 102, 58,  114,
    117, 110, 40,  102, 110, 44,  32,  46,  46,  46,  41,  10,  32,  32,  32,
    32,  32,  32,  32,  32,  105, 102, 32,  98,  117, 102, 102, 101, 114, 32,
    116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    114, 101, 116, 117, 114, 110, 32,  99,  111, 110, 99,  97,  116, 40,  98,
    117, 102, 102, 101, 114, 41,  10,  32,  32,  32,  32,  32,  32,  32,  32,
    101, 108, 115, 101, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    114, 101, 116, 117, 114, 110, 32,  110, 105, 108, 44,  32,  101, 114, 114,
    10,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,
    32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  101, 110, 100,
    44,  10,  32,  32,  32,  32,  112, 97,  114, 115, 101, 32,  61,  32,  102,
    117, 110, 99,  116, 105, 111, 110, 40,  115, 101, 108, 102, 44,  32,  115,
    116, 114, 41,  10,  32,  32,  32,  32,  32,  32,  115, 101, 108, 102, 46,
    115, 116, 114, 32,  61,  32,  115, 116, 114, 10,  32,  32,  32,  32,  32,
    32,  97,  115, 115, 101, 114, 116, 40,  116, 121, 112, 101, 40,  115, 101,
    108, 102, 46,  115, 116, 114, 41,  32,  61,  61,  32,  34,  115, 116, 114,
    105, 110, 103, 34,  44,  32,  34,  101, 120, 112, 101, 99,  116, 105, 110,
    103, 32,  115, 116, 114, 105, 110, 103, 32,  102, 111, 114, 32,  112, 97,
    114, 115, 101, 34,  41,  10,  32,  32,  32,  32,  32,  32,  115, 101, 108,
    102, 46,  112, 111, 115, 32,  61,  32,  49,  10,  32,  32,  32,  32,  32,
    32,  115, 101, 108, 102, 46,  99,  104, 117, 110, 107, 115, 32,  61,  32,
    123, 32,  125, 10,  32,  32,  32,  32,  32,  32,  119, 104, 105, 108, 101,
    32,  116, 114, 117, 101, 32,  100, 111, 10,  32,  32,  32,  32,  32,  32,
    32,  32,  108, 111, 99,  97,  108, 32,  102, 111, 117, 110, 100, 44,  32,
    101, 114, 114, 32,  61,  32,  115, 101, 108, 102, 58,  110, 101, 120, 116,
    95,  116, 97,  103, 40,  41,  10,  32,  32,  32,  32,  32,  32,  32,  32,
    105, 102, 32,  101, 114, 114, 32,  116, 104, 101, 110, 10,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  110,
    105, 108, 44,  32,  101, 114, 114, 10,  32,  32,  32,  32,  32,  32,  32,
    32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  32,  32,  105, 102,
    32,  110, 111, 116, 32,  40,  102, 111, 117, 110, 100, 41,  32,  116, 104,
    101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  98,  114,
    101, 97,  107, 10,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100,
    10,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,
    32,  32,  114, 101, 116, 117, 114, 110, 32,  116, 114, 117, 101, 10,  32,
    32,  32,  32,  101, 110, 100, 44,  10,  32,  32,  32,  32,  112, 97,  114,
    115, 101, 95,  101, 114, 114, 111, 114, 32,  61,  32,  102, 117, 110, 99,
    116, 105, 111, 110, 40,  115, 101, 108, 102, 44,  32,  101, 114, 114, 44,
    32,  99,  111, 100, 101, 41,  10,  32,  32,  32,  32,  32,  32,  108, 111,
    99,  97,  108, 32,  108, 105, 110, 101, 95,  110, 111, 44,  32,  101, 114,
    114, 95,  109, 115, 103, 32,  61,  32,  101, 114, 114, 58,  109, 97,  116,
    99,  104, 40,  34,  37,  91,  46,  45,  37,  93,  58,  40,  37,  100, 43,
    41,  58,  32,  40,  46,  42,  41,  36,  34,  41,  10,  32,  32,  32,  32,
    32,  32,  108, 105, 110, 101, 95,  110, 111, 32,  61,  32,  116, 111, 110,
    117, 109, 98,  101, 114, 40,  108, 105, 110, 101, 95,  110, 111, 41,  10,
    32,  32,  32,  32,  32,  32,  105, 102, 32,  110, 111, 116, 32,  40,  108,
    105, 110, 101, 95,  110, 111, 41,  32,  116, 104, 101, 110, 10,  32,  32,
    32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  10,  32,
    32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,
    108, 111, 99,  97,  108, 32,  108, 105, 110, 101, 32,  61,  32,  103, 101,
    116, 95,  108, 105, 110, 101, 40,  99,  111, 100, 101, 44,  32,  108, 105,
    110, 101, 95,  110, 111, 41,  10,  32,  32,  32,  32,  32,  32,  108, 111,
    99,  97,  108, 32,  115, 111, 117, 114, 99,  101, 95,  112, 111, 115, 32,
    61,  32,  116, 111, 110, 117, 109, 98,  101, 114, 40,  108, 105, 110, 101,
    58,  109, 97,  116, 99,  104, 40,  34,  94,  37,  45,  37,  45,  37,  91,
    37,  91,  40,  37,  100, 43,  41,  37,  93,  37,  93,  34,  41,  41,  10,
    32,  32,  32,  32,  32,  32,  105, 102, 32,  110, 111, 116, 32,  40,  115,
    111, 117, 114, 99,  101, 95,  112, 111, 115, 41,  32,  116, 104, 101, 110,
    10,  32,  32,  32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110,
    32,  10,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,
    32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  115, 101, 108, 102, 58,
    101, 114, 114, 111, 114, 95,  102, 111, 114, 95,  112, 111, 115, 40,  115,
    111, 117, 114, 99,  101, 95,  112, 111, 115, 44,  32,  101, 114, 114, 95,
    109, 115, 103, 41,  10,  32,  32,  32,  32,  101, 110, 100, 44,  10,  32,
    32,  32,  32,  101, 114, 114, 111, 114, 95,  102, 111, 114, 95,  112, 111,
    115, 32,  61,  32,  102, 117, 110, 99,  116, 105, 111, 110, 40,  115, 101,
    108, 102, 44,  32,  115, 111, 117, 114, 99,  101, 95,  112, 111, 115, 44,
    32,  101, 114, 114, 95,  109, 115, 103, 41,  10,  32,  32,  32,  32,  32,
    32,  108, 111, 99,  97,  108, 32,  115, 111, 117, 114, 99,  101, 95,  108,
    105, 110, 101, 95,  110, 111, 32,  61,  32,  112, 111, 115, 95,  116, 111,
    95,  108, 105, 110, 101, 40,  115, 101, 108, 102, 46,  115, 116, 114, 44,
    32,  115, 111, 117, 114, 99,  101, 95,  112, 111, 115, 41,  10,  32,  32,
    32,  32,  32,  32,  108, 111, 99,  97,  108, 32,  115, 111, 117, 114, 99,
    101, 95,  108, 105, 110, 101, 32,  61,  32,  103, 101, 116, 95,  108, 105,
    110, 101, 40,  115, 101, 108, 102, 46,  115, 116, 114, 44,  32,  115, 111,
    117, 114, 99,  101, 95,  108, 105, 110, 101, 95,  110, 111, 41,  10,  32,
    32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  116, 111, 115,
    116, 114, 105, 110, 103, 40,  101, 114, 114, 95,  109, 115, 103, 41,  32,
    46,  46,  32,  34,  32,  91,  34,  32,  46,  46,  32,  116, 111, 115, 116,
    114, 105, 110, 103, 40,  115, 111, 117, 114, 99,  101, 95,  108, 105, 110,
    101, 95,  110, 111, 41,  32,  46,  46,  32,  34,  93,  58,  32,  34,  32,
    46,  46,  32,  116, 111, 115, 116, 114, 105, 110, 103, 40,  115, 111, 117,
    114, 99,  101, 95,  108, 105, 110, 101, 41,  10,  32,  32,  32,  32,  101,
    110, 100, 44,  10,  32,  32,  32,  32,  108, 111, 97,  100, 32,  61,  32,
    102, 117, 110, 99,  116, 105, 111, 110, 40,  115, 101, 108, 102, 44,  32,
    99,  111, 100, 101, 44,  32,  110, 97,  109, 101, 41,  10,  32,  32,  32,
    32,  32,  32,  105, 102, 32,  110, 97,  109, 101, 32,  61,  61,  32,  110,
    105, 108, 32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,
    32,  110, 97,  109, 101, 32,  61,  32,  34,  101, 116, 108, 117, 97,  34,
    10,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,
    32,  32,  108, 111, 99,  97,  108, 32,  99,  111, 100, 101, 95,  102, 110,
    10,  32,  32,  32,  32,  32,  32,  100, 111, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  108, 111, 99,  97,  108, 32,  99,  111, 100, 101, 95,  114,
    101, 102, 32,  61,  32,  99,  111, 100, 101, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  99,  111, 100, 101, 95,  102, 110, 32,  61,  32,  102, 117,
    110, 99,  116, 105, 111, 110, 40,  41,  10,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  100, 111, 10,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  108, 111, 99,  97,  108, 32,  114, 101, 116, 32,  61,
    32,  99,  111, 100, 101, 95,  114, 101, 102, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  99,  111, 100, 101, 95,  114, 101, 102,
    32,  61,  32,  110, 105, 108, 10,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  114, 101, 116, 10,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,
    32,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,
    32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  108, 111, 99,
    97,  108, 32,  102, 110, 44,  32,  101, 114, 114, 32,  61,  32,  108, 111,
    97,  100, 40,  99,  111, 100, 101, 95,  102, 110, 44,  32,  110, 97,  109,
    101, 41,  10,  32,  32,  32,  32,  32,  32,  105, 102, 32,  110, 111, 116,
    32,  40,  102, 110, 41,  32,  116, 104, 101, 110, 10,  32,  32,  32,  32,
    32,  32,  32,  32,  100, 111, 10,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  108, 111, 99,  97,  108, 32,  101, 114, 114, 95,  109, 115, 103,
    32,  61,  32,  115, 101, 108, 102, 58,  112, 97,  114, 115, 101, 95,  101,
    114, 114, 111, 114, 40,  101, 114, 114, 44,  32,  99,  111, 100, 101, 41,
    10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  105, 102, 32,  101,
    114, 114, 95,  109, 115, 103, 32,  116, 104, 101, 110, 10,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110,
    32,  110, 105, 108, 44,  32,  101, 114, 114, 95,  109, 115, 103, 10,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,
    32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  110, 105, 108, 44,  32,
    101, 114, 114, 10,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,
    32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  102, 110, 10,
    32,  32,  32,  32,  101, 110, 100, 44,  10,  32,  32,  32,  32,  114, 117,
    110, 32,  61,  32,  102, 117, 110, 99,  116, 105, 111, 110, 40,  115, 101,
    108, 102, 44,  32,  102, 110, 44,  32,  101, 110, 118, 44,  32,  98,  117,
    102, 102, 101, 114, 44,  32,  105, 44,  32,  46,  46,  46,  41,  10,  32,
    32,  32,  32,  32,  32,  105, 102, 32,  101, 110, 118, 32,  61,  61,  32,
    110, 105, 108, 32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,
    32,  32,  101, 110, 118, 32,  61,  32,  123, 32,  125, 10,  32,  32,  32,
    32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  108, 111,
    99,  97,  108, 32,  99,  111, 109, 98,  105, 110, 101, 100, 95,  101, 110,
    118, 32,  61,  32,  115, 101, 116, 109, 101, 116, 97,  116, 97,  98,  108,
    101, 40,  123, 32,  125, 44,  32,  123, 10,  32,  32,  32,  32,  32,  32,
    32,  32,  95,  95,  105, 110, 100, 101, 120, 32,  61,  32,  102, 117, 110,
    99,  116, 105, 111, 110, 40,  115, 101, 108, 102, 44,  32,  110, 97,  109,
    101, 41,  10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  108, 111,
    99,  97,  108, 32,  118, 97,  108, 32,  61,  32,  101, 110, 118, 91,  110,
    97,  109, 101, 93,  10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    105, 102, 32,  118, 97,  108, 32,  61,  61,  32,  110, 105, 108, 32,  116,
    104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  118, 97,  108, 32,  61,  32,  95,  71,  91,  110, 97,  109, 101, 93,
    10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  101, 110, 100, 10,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114,
    110, 32,  118, 97,  108, 10,  32,  32,  32,  32,  32,  32,  32,  32,  101,
    110, 100, 10,  32,  32,  32,  32,  32,  32,  125, 41,  10,  32,  32,  32,
    32,  32,  32,  105, 102, 32,  110, 111, 116, 32,  40,  98,  117, 102, 102,
    101, 114, 41,  32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,
    32,  32,  98,  117, 102, 102, 101, 114, 32,  61,  32,  123, 32,  125, 10,
    32,  32,  32,  32,  32,  32,  32,  32,  105, 32,  61,  32,  48,  10,  32,
    32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,
    115, 101, 116, 102, 101, 110, 118, 40,  102, 110, 44,  32,  99,  111, 109,
    98,  105, 110, 101, 100, 95,  101, 110, 118, 41,  10,  32,  32,  32,  32,
    32,  32,  114, 101, 116, 117, 114, 110, 32,  102, 110, 40,  116, 111, 115,
    116, 114, 105, 110, 103, 44,  32,  104, 116, 109, 108, 95,  101, 115, 99,
    97,  112, 101, 44,  32,  98,  117, 102, 102, 101, 114, 44,  32,  105, 44,
    32,  46,  46,  46,  41,  10,  32,  32,  32,  32,  101, 110, 100, 44,  10,
    32,  32,  32,  32,  99,  111, 109, 112, 105, 108, 101, 95,  116, 111, 95,
    108, 117, 97,  32,  61,  32,  102, 117, 110, 99,  116, 105, 111, 110, 40,
    115, 101, 108, 102, 44,  32,  115, 116, 114, 44,  32,  46,  46,  46,  41,
    10,  32,  32,  32,  32,  32,  32,  108, 111, 99,  97,  108, 32,  115, 117,
    99,  99,  101, 115, 115, 44,  32,  101, 114, 114, 32,  61,  32,  115, 101,
    108, 102, 58,  112, 97,  114, 115, 101, 40,  115, 116, 114, 41,  10,  32,
    32,  32,  32,  32,  32,  105, 102, 32,  110, 111, 116, 32,  40,  115, 117,
    99,  99,  101, 115, 115, 41,  32,  116, 104, 101, 110, 10,  32,  32,  32,
    32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  110, 105, 108,
    44,  32,  101, 114, 114, 10,  32,  32,  32,  32,  32,  32,  101, 110, 100,
    10,  32,  32,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110, 32,  115,
    101, 108, 102, 58,  99,  104, 117, 110, 107, 115, 95,  116, 111, 95,  108,
    117, 97,  40,  46,  46,  46,  41,  10,  32,  32,  32,  32,  101, 110, 100,
    44,  10,  32,  32,  32,  32,  99,  104, 117, 110, 107, 115, 95,  116, 111,
    95,  108, 117, 97,  32,  61,  32,  102, 117, 110, 99,  116, 105, 111, 110,
    40,  115, 101, 108, 102, 44,  32,  99,  111, 109, 112, 105, 108, 101, 114,
    95,  99,  108, 115, 41,  10,  32,  32,  32,  32,  32,  32,  105, 102, 32,
    99,  111, 109, 112, 105, 108, 101, 114, 95,  99,  108, 115, 32,  61,  61,
    32,  110, 105, 108, 32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  99,  111, 109, 112, 105, 108, 101, 114, 95,  99,  108, 115,
    32,  61,  32,  67,  111, 109, 112, 105, 108, 101, 114, 10,  32,  32,  32,
    32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  108, 111,
    99,  97,  108, 32,  114, 32,  61,  32,  99,  111, 109, 112, 105, 108, 101,
    114, 95,  99,  108, 115, 40,  41,  10,  32,  32,  32,  32,  32,  32,  114,
    58,  104, 101, 97,  100, 101, 114, 40,  41,  10,  32,  32,  32,  32,  32,
    32,  108, 111, 99,  97,  108, 32,  95,  108, 105, 115, 116, 95,  48,  32,
    61,  32,  115, 101, 108, 102, 46,  99,  104, 117, 110, 107, 115, 10,  32,
    32,  32,  32,  32,  32,  102, 111, 114, 32,  95,  105, 110, 100, 101, 120,
    95,  48,  32,  61,  32,  49,  44,  32,  35,  95,  108, 105, 115, 116, 95,
    48,  32,  100, 111, 10,  32,  32,  32,  32,  32,  32,  32,  32,  108, 111,
    99,  97,  108, 32,  99,  104, 117, 110, 107, 32,  61,  32,  95,  108, 105,
    115, 116, 95,  48,  91,  95,  105, 110, 100, 101, 120, 95,  48,  93,  10,
    32,  32,  32,  32,  32,  32,  32,  32,  108, 111, 99,  97,  108, 32,  116,
    32,  61,  32,  116, 121, 112, 101, 40,  99,  104, 117, 110, 107, 41,  10,
    32,  32,  32,  32,  32,  32,  32,  32,  105, 102, 32,  116, 32,  61,  61,
    32,  34,  116, 97,  98,  108, 101, 34,  32,  116, 104, 101, 110, 10,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  32,  116, 32,  61,  32,  99,  104,
    117, 110, 107, 91,  49,  93,  10,  32,  32,  32,  32,  32,  32,  32,  32,
    101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  32,  32,  108, 111, 99,
    97,  108, 32,  95,  101, 120, 112, 95,  48,  32,  61,  32,  116, 10,  32,
    32,  32,  32,  32,  32,  32,  32,  105, 102, 32,  34,  115, 116, 114, 105,
    110, 103, 34,  32,  61,  61,  32,  95,  101, 120, 112, 95,  48,  32,  116,
    104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  114,
    58,  105, 110, 99,  114, 101, 109, 101, 110, 116, 40,  41,  10,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  114, 58,  97,  115, 115, 105, 103,
    110, 40,  40,  34,  37,  113, 34,  41,  58,  102, 111, 114, 109, 97,  116,
    40,  99,  104, 117, 110, 107, 41,  41,  10,  32,  32,  32,  32,  32,  32,
    32,  32,  101, 108, 115, 101, 105, 102, 32,  34,  99,  111, 100, 101, 34,
    32,  61,  61,  32,  95,  101, 120, 112, 95,  48,  32,  116, 104, 101, 110,
    10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  114, 58,  109, 97,
    114, 107, 40,  99,  104, 117, 110, 107, 91,  51,  93,  41,  10,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  114, 58,  112, 117, 115, 104, 40,
    99,  104, 117, 110, 107, 91,  50,  93,  44,  32,  34,  92,  110, 34,  41,
    10,  32,  32,  32,  32,  32,  32,  32,  32,  101, 108, 115, 101, 105, 102,
    32,  34,  61,  34,  32,  61,  61,  32,  95,  101, 120, 112, 95,  48,  32,
    111, 114, 32,  34,  45,  34,  32,  61,  61,  32,  95,  101, 120, 112, 95,
    48,  32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  114, 58,  105, 110, 99,  114, 101, 109, 101, 110, 116, 40,  41,
    10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  114, 58,  109, 97,
    114, 107, 40,  99,  104, 117, 110, 107, 91,  51,  93,  41,  10,  32,  32,
    32,  32,  32,  32,  32,  32,  32,  32,  114, 58,  97,  115, 115, 105, 103,
    110, 40,  41,  10,  32,  32,  32,  32,  32,  32,  32,  32,  32,  32,  105,
    102, 32,  116, 32,  61,  61,  32,  34,  61,  34,  32,  97,  110, 100, 32,
    115, 101, 108, 102, 46,  104, 116, 109, 108, 95,  101, 115, 99,  97,  112,
    101, 32,  116, 104, 101, 110, 10,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  32,  114, 58,  112, 117, 115, 104, 40,  34,  95,  101, 115,
    99,  97,  112, 101, 40,  95,  116, 111, 115, 116, 114, 105, 110, 103, 40,
    34,  44,  32,  99,  104, 117, 110, 107, 91,  50,  93,  44,  32,  34,  41,
    41,  92,  110, 34,  41,  10,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  101, 108, 115, 101, 10,  32,  32,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  114, 58,  112, 117, 115, 104, 40,  34,  95,  116, 111, 115,
    116, 114, 105, 110, 103, 40,  34,  44,  32,  99,  104, 117, 110, 107, 91,
    50,  93,  44,  32,  34,  41,  92,  110, 34,  41,  10,  32,  32,  32,  32,
    32,  32,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,
    32,  32,  32,  101, 108, 115, 101, 10,  32,  32,  32,  32,  32,  32,  32,
    32,  32,  32,  101, 114, 114, 111, 114, 40,  34,  117, 110, 107, 110, 111,
    119, 110, 32,  116, 121, 112, 101, 32,  34,  32,  46,  46,  32,  116, 111,
    115, 116, 114, 105, 110, 103, 40,  116, 41,  41,  10,  32,  32,  32,  32,
    32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  32,  32,  32,  32,  101,
    110, 100, 10,  32,  32,  32,  32,  32,  32,  114, 58,  102, 111, 111, 116,
    101, 114, 40,  41,  10,  32,  32,  32,  32,  32,  32,  114, 101, 116, 117,
    114, 110, 32,  114, 58,  114, 101, 110, 100, 101, 114, 40,  41,  10,  32,
    32,  32,  32,  101, 110, 100, 10,  32,  32,  125, 10,  32,  32,  95,  98,
    97,  115, 101, 95,  48,  46,  95,  95,  105, 110, 100, 101, 120, 32,  61,
    32,  95,  98,  97,  115, 101, 95,  48,  10,  32,  32,  95,  99,  108, 97,
    115, 115, 95,  48,  32,  61,  32,  115, 101, 116, 109, 101, 116, 97,  116,
    97,  98,  108, 101, 40,  123, 10,  32,  32,  32,  32,  95,  95,  105, 110,
    105, 116, 32,  61,  32,  102, 117, 110, 99,  116, 105, 111, 110, 40,  41,
    32,  101, 110, 100, 44,  10,  32,  32,  32,  32,  95,  95,  98,  97,  115,
    101, 32,  61,  32,  95,  98,  97,  115, 101, 95,  48,  44,  10,  32,  32,
    32,  32,  95,  95,  110, 97,  109, 101, 32,  61,  32,  34,  80,  97,  114,
    115, 101, 114, 34,  10,  32,  32,  125, 44,  32,  123, 10,  32,  32,  32,
    32,  95,  95,  105, 110, 100, 101, 120, 32,  61,  32,  95,  98,  97,  115,
    101, 95,  48,  44,  10,  32,  32,  32,  32,  95,  95,  99,  97,  108, 108,
    32,  61,  32,  102, 117, 110, 99,  116, 105, 111, 110, 40,  99,  108, 115,
    44,  32,  46,  46,  46,  41,  10,  32,  32,  32,  32,  32,  32,  108, 111,
    99,  97,  108, 32,  95,  115, 101, 108, 102, 95,  48,  32,  61,  32,  115,
    101, 116, 109, 101, 116, 97,  116, 97,  98,  108, 101, 40,  123, 125, 44,
    32,  95,  98,  97,  115, 101, 95,  48,  41,  10,  32,  32,  32,  32,  32,
    32,  99,  108, 115, 46,  95,  95,  105, 110, 105, 116, 40,  95,  115, 101,
    108, 102, 95,  48,  44,  32,  46,  46,  46,  41,  10,  32,  32,  32,  32,
    32,  32,  114, 101, 116, 117, 114, 110, 32,  95,  115, 101, 108, 102, 95,
    48,  10,  32,  32,  32,  32,  101, 110, 100, 10,  32,  32,  125, 41,  10,
    32,  32,  95,  98,  97,  115, 101, 95,  48,  46,  95,  95,  99,  108, 97,
    115, 115, 32,  61,  32,  95,  99,  108, 97,  115, 115, 95,  48,  10,  32,
    32,  80,  97,  114, 115, 101, 114, 32,  61,  32,  95,  99,  108, 97,  115,
    115, 95,  48,  10,  101, 110, 100, 10,  108, 111, 99,  97,  108, 32,  99,
    111, 109, 112, 105, 108, 101, 10,  100, 111, 10,  32,  32,  108, 111, 99,
    97,  108, 32,  95,  98,  97,  115, 101, 95,  48,  32,  61,  32,  80,  97,
    114, 115, 101, 114, 40,  41,  10,  32,  32,  108, 111, 99,  97,  108, 32,
    95,  102, 110, 95,  48,  32,  61,  32,  95,  98,  97,  115, 101, 95,  48,
    46,  99,  111, 109, 112, 105, 108, 101, 10,  32,  32,  99,  111, 109, 112,
    105, 108, 101, 32,  61,  32,  102, 117, 110, 99,  116, 105, 111, 110, 40,
    46,  46,  46,  41,  10,  32,  32,  32,  32,  114, 101, 116, 117, 114, 110,
    32,  95,  102, 110, 95,  48,  40,  95,  98,  97,  115, 101, 95,  48,  44,
    32,  46,  46,  46,  41,  10,  32,  32,  101, 110, 100, 10,  101, 110, 100,
    10,  108, 111, 99,  97,  108, 32,  114, 101, 110, 100, 101, 114, 10,  114,
    101, 110, 100, 101, 114, 32,  61,  32,  102, 117, 110, 99,  116, 105, 111,
    110, 40,  115, 116, 114, 44,  32,  46,  46,  46,  41,  10,  32,  32,  108,
    111, 99,  97,  108, 32,  102, 110, 44,  32,  101, 114, 114, 32,  61,  32,
    99,  111, 109, 112, 105, 108, 101, 40,  115, 116, 114, 41,  10,  32,  32,
    105, 102, 32,  102, 110, 32,  116, 104, 101, 110, 10,  32,  32,  32,  32,
    114, 101, 116, 117, 114, 110, 32,  102, 110, 40,  46,  46,  46,  41,  10,
    32,  32,  101, 108, 115, 101, 10,  32,  32,  32,  32,  114, 101, 116, 117,
    114, 110, 32,  110, 105, 108, 44,  32,  101, 114, 114, 10,  32,  32,  101,
    110, 100, 10,  101, 110, 100, 10,  114, 101, 116, 117, 114, 110, 32,  123,
    10,  32,  32,  99,  111, 109, 112, 105, 108, 101, 32,  61,  32,  99,  111,
    109, 112, 105, 108, 101, 44,  10,  32,  32,  114, 101, 110, 100, 101, 114,
    32,  61,  32,  114, 101, 110, 100, 101, 114, 44,  10,  32,  32,  80,  97,
    114, 115, 101, 114, 32,  61,  32,  80,  97,  114, 115, 101, 114, 44,  10,
    32,  32,  67,  111, 109, 112, 105, 108, 101, 114, 32,  61,  32,  67,  111,
    109, 112, 105, 108, 101, 114, 44,  10,  32,  32,  95,  118, 101, 114, 115,
    105, 111, 110, 32,  61,  32,  86,  69,  82,  83,  73,  79,  78,  10,  125,
    10};

void pushtableliteral(lua_State *L, const char *key, const char *value) {
  lua_pushstring(L, key);
  lua_pushstring(L, value);
  lua_settable(L, -3);
}

void pushtablestring(lua_State *L, const char *key, char *value) {
  lua_pushstring(L, key);
  lua_pushstring(L, value);
  lua_settable(L, -3);
}

void pushtablelstring(lua_State *L, const char *key, char *value,
                      int valsize) {
  lua_pushstring(L, key);
  lua_pushlstring(L, value, valsize);
  lua_settable(L, -3);
}

void pushtableint(lua_State *L, const char *key, int value) {
  lua_pushstring(L, key);
  lua_pushinteger(L, value);
  lua_settable(L, -3);
}

bool match(lua_State *L, char *str, const char *pattern) {
  lua_getglobal(L, "string");
  lua_getfield(L, 1, "match");
  lua_pushstring(L, str);
  lua_pushstring(L, pattern);

  bool matched = lua_pcall(L, 2, 1, 0) == LUA_OK && lua_isstring(L, -1);

  lua_pop(L, 2);

  return matched;
}

char *replace(lua_State *L, char *str, const char *pattern, const char *repl) {
  lua_getglobal(L, "string");
  lua_getfield(L, 1, "gsub");
  lua_pushstring(L, str);
  lua_pushstring(L, pattern);
  lua_pushstring(L, repl);

  char *result = NULL;
  if (lua_pcall(L, 3, 1, 0) == LUA_OK && lua_isstring(L, -1)) {
    result = sqlite3_mprintf("%s", lua_tostring(L, -1));
  }

  lua_pop(L, 2);

  return result;
}

char *mime_type(lua_State *L, char *path) {
  magic_t cookie = magic_open(MAGIC_MIME_TYPE);
  if (cookie == NULL) {
    syslog(LOG_ERR, "Failed opening libmagic cookie: %m");
    return NULL;
  }

  char *result = NULL;

  if (magic_load(cookie, NULL) != 0) {
    syslog(LOG_ERR, "Failed loading libmagic DB: %s", magic_error(cookie));
    goto cleanup;
  }

  const char *mime = magic_file(cookie, path);
  if (mime == NULL) {
    syslog(LOG_ERR, "Failed parsing magic file: %s", magic_error(cookie));
    goto cleanup;
  }

  if (strcmp(mime, "text/plain") == 0) {
    if (match(L, path, "%.css$")) {
      mime = "text/css";
    } else if (match(L, path, "%.lua$")) {
      mime = "text/x-lua";
    }
  }

  result = sqlite3_mprintf("%s", mime);

cleanup:
  magic_close(cookie);

  return result;
}

void dumpstack(lua_State *L) {
  int top = lua_gettop(L);
  for (int i = 1; i <= top; i++) {
    printf("%d\t%s\t", i, luaL_typename(L, i));
    switch (lua_type(L, i)) {
    case LUA_TNUMBER:
      printf("%g\n", lua_tonumber(L, i));
      break;
    case LUA_TSTRING:
      printf("%s\n", lua_tostring(L, i));
      break;
    case LUA_TBOOLEAN:
      printf("%s\n", (lua_toboolean(L, i) ? "true" : "false"));
      break;
    case LUA_TNIL:
      printf("%s\n", "nil");
      break;
    default:
      printf("%p\n", lua_topointer(L, i));
      break;
    }
  }
}

static int open_etlua(lua_State *L) {
  if (luaL_loadstring(L, (const char *)etlua) != LUA_OK) {
    return lua_error(L);
  }
  lua_call(L, 0, 1);
  return 1;
}

int render_tmpl(lua_State *L) {
  // stack: [db, slug, context]

  sqlite3 *db = (sqlite3 *)lua_touserdata(L, 1);
  char *tmpl_name = sqlite3_mprintf("%s", lua_tostring(L, 2));

  luaL_requiref(L, "etlua", open_etlua, 0);
  // stack: [db, slug, context, etlua]

  sqlite3_stmt *stmt;
  int rc = sqlite3_prepare_v2(db,
                              "SELECT content, template"
                              "  FROM resources"
                              " WHERE slug = ?",
                              -1, &stmt, NULL);
  if (rc) {
    lua_pushfstring(L, "Failed preparing template statement: %s",
                    sqlite3_errstr(rc));
    goto cleanup;
  }

  while (true) {
    if (lua_getfield(L, 4, "render") != LUA_TFUNCTION) {
      lua_pushfstring(L, "Failed getting render function: got %s",
                      lua_typename(L, lua_type(L, -1)));
      goto cleanup;
    }
    // stack: [db, slug, context, etlua, render]

    rc = sqlite3_bind_text(stmt, 1, tmpl_name, -1, NULL);
    if (rc) {
      lua_pushfstring(L, "Failed binding template slug: %s",
                      sqlite3_errstr(rc));
      goto cleanup;
    }

    int rc = sqlite3_step(stmt);
    if (rc != SQLITE_ROW) {
      lua_pushfstring(L, "Failed loading template %s: %s", tmpl_name,
                      sqlite3_errstr(rc));
      goto cleanup;
    }

    if (sqlite3_column_type(stmt, 0) == SQLITE_NULL) {
      lua_pushfstring(L, "Failed getting template: content is NULL");
      goto cleanup;
    }

    const void *tmpl = sqlite3_column_blob(stmt, 0);
    int tmpl_size = sqlite3_column_bytes(stmt, 0);

    lua_pushlstring(L, tmpl, tmpl_size);
    // stack: [db, slug, context, etlua, render, template]

    sqlite3_free(tmpl_name);
    tmpl_name = sqlite3_mprintf("%s", sqlite3_column_text(stmt, 1));

    lua_pushnil(L);
    lua_copy(L, 3, 7);
    // stack: [db, slug, context, etlua, render, template, context]

    rc = lua_pcall(L, 2, 1, 0);
    if (rc != LUA_OK) {
      lua_pushfstring(L, "Failed rendering template: %s", lua_tostring(L, -1));
      goto cleanup;
    }
    // stack: [db, slug, context, etlua, output]

    if (lua_isnil(L, -1)) {
      lua_pushfstring(L, "Failed rendering template: got nil");
      goto cleanup;
    }

    if (strcmp(tmpl_name, "") != 0) {
      lua_setfield(L, 3, "content");
      sqlite3_reset(stmt);
      continue;
      // stack: [db, slug, context, etlua]
    }

    break;
  }

cleanup:
  sqlite3_free(tmpl_name);
  sqlite3_finalize(stmt);
  if (rc)
    return lua_error(L);

  return 1;
}

int base64enc(lua_State *L) {
  size_t inpsz;
  const char *inp = luaL_checklstring(L, 1, &inpsz);

  size_t outsz = ((inpsz + 2) / 3 * 4) + 1;
  char *out = malloc(outsz);
  if (b64_ntop((const unsigned char *)inp, inpsz, out, outsz) == -1) {
    lua_pushstring(L, "failed encoding in base64");
    return lua_error(L);
  }

  lua_pushlstring(L, (const char *)out, outsz);

  return 1;
}

int base64dec(lua_State *L) {
  size_t inpsz;
  const char *inp = luaL_checklstring(L, 1, &inpsz);

  size_t outsz = inpsz / 4 * 3;
  unsigned char *out = malloc(outsz + 1); /* NUL terminator */

  int c;

  if ((c = b64_pton(inp, out, outsz)) == -1) {
    lua_pushstring(L, "failed decoding from base64");
    return lua_error(L);
  }

  out[c] = '\0'; /* NUL termination */

  lua_pushlstring(L, (const char *)out, outsz);

  return 1;
}

int query_db(lua_State *L) {
  if (!lua_islightuserdata(L, 1)) {
    return luaL_argerror(L, 1, "must be a database connection");
  }

  sqlite3 *db = (sqlite3 *)lua_touserdata(L, 1);
  const char *sql = luaL_checkstring(L, 2);

  int rc = 0;
  sqlite3_stmt *stmt;
  struct bind_param *params = 0;

  rc = sqlite3_prepare_v2(db, sql, -1, &stmt, NULL);
  if (rc) {
    lua_pushfstring(L, "prepare failed: %s", sqlite3_errstr(rc));
    goto cleanup;
  }

  int num_params = sqlite3_bind_parameter_count(stmt);

  params = malloc(sizeof(struct bind_param) * num_params);

  if (num_params > 0 && num_params < MAX_PARAMS) {
    for (int i = 0; i < num_params; i++) {
      int si = i + 3;
      switch (lua_type(L, si)) {
      case LUA_TSTRING:
        params[i] =
            sqlite_bind(SQLITE_TEXT, 0, 0, (char *)lua_tostring(L, si), 0);
        break;
      case LUA_TBOOLEAN:
        params[i] =
            sqlite_bind(SQLITE_INTEGER, lua_toboolean(L, si), 0, NULL, 0);
        break;
      case LUA_TNUMBER:
        if (lua_isinteger(L, si)) {
          params[i] =
              sqlite_bind(SQLITE_INTEGER, lua_tointeger(L, si), 0, NULL, 0);
          break;
        } else {
          params[i] =
              sqlite_bind(SQLITE_FLOAT, 0, lua_tonumber(L, si), NULL, 0);
          break;
        }
      case LUA_TNIL:
        params[i] = sqlite_bind(SQLITE_NULL, 0, 0, NULL, 0);
        break;
      }
    }

    rc = bind_params(&stmt, num_params, params);
    if (rc) {
      lua_pushfstring(L, "Failed biding parameters: %s", sqlite3_errstr(rc));
      goto cleanup;
    }
  }

  int num_rows = 0;

  lua_newtable(L);

  while (true) {
    rc = sqlite3_step(stmt);
    if (rc == SQLITE_DONE) {
      rc = 0;
      break;
    } else if (rc != SQLITE_ROW) {
      lua_pushfstring(L, "Failed executing statement: %s", sqlite3_errstr(rc));
      goto cleanup;
    }

    num_rows++;
    int num_cols = sqlite3_column_count(stmt);
    lua_pushinteger(L, num_rows);
    lua_createtable(L, num_cols, 0);
    for (int i = 0; i < num_cols; i++) {
      lua_pushstring(L, sqlite3_column_name(stmt, i));
      switch (sqlite3_column_type(stmt, i)) {
      case SQLITE_TEXT:
        lua_pushstring(L, (char *)sqlite3_column_text(stmt, i));
        break;
      case SQLITE_INTEGER:
        lua_pushinteger(L, sqlite3_column_int(stmt, i));
        break;
      case SQLITE_FLOAT:
        lua_pushnumber(L, sqlite3_column_double(stmt, i));
        break;
      case SQLITE_BLOB:
        lua_pushlightuserdata(L, (void *)sqlite3_column_blob(stmt, i));
        break;
      case SQLITE_NULL:
        lua_pushnil(L);
        break;
      default:
        rc = 1;
        lua_pushfstring(L, "Unknown column return type for %d", i);
        goto cleanup;
      }
      lua_settable(L, -3);
    }
    lua_settable(L, -3);
    rc = 0;
  }

cleanup:
  sqlite3_finalize(stmt);

  if (params)
    free(params);
  if (rc)
    return lua_error(L);

  return 1;
}

static unsigned char *read_fd(lua_State *L, int fd, int *size) {
  unsigned char *output;

  while (true) {
    const size_t read_size = 512;
    unsigned char buf[read_size];
    int nread = read(fd, buf, read_size);
    switch (nread) {
    case -1:
      if (errno == EAGAIN) {
        sleep(1);
        break;
      } else {
        lua_pushfstring(L, "Failed reading command stdout: %s (code: %d)",
                        strerror(errno), errno);
        return NULL;
      }
    case 0:
      output[*size] = 0;
      *size += 1;
      close(fd);
      return output;
    default:
      if (*size)
        output = realloc(output, *size + nread + 1);
      else
        output = malloc(nread + 1);

      if (*size == 0) {
        memcpy(output, buf, nread);
      } else {
        memcpy(output + *size - 1, buf, nread);
      }

      *size += nread;
      break;
    }
  }
}

int execute_cmd(lua_State *L) {
  syslog(LOG_DEBUG, "Executing command");

  bool has_stdin = lua_gettop(L) == 3;

  const char *cmd = luaL_checkstring(L, 1);

  int num_args = luaL_len(L, 2);
  char *argv[num_args + 2];
  argv[0] = (char *)cmd;
  for (int i = 0; i < num_args; i++) {
    lua_pushinteger(L, i + 1);
    lua_gettable(L, 2);
    argv[i + 1] = (char *)lua_tostring(L, -1);
  }
  argv[num_args + 1] = NULL;

  size_t inp_size = 0;
  char *inp;
  if (has_stdin)
    inp = (char *)luaL_checklstring(L, 3, &inp_size);

  int stdin_pipe[2], stdout_pipe[2];
  pid_t childpid;

  if (pipe(stdin_pipe) == -1)
    return luaL_error(L, "Failed creating stdin pipe: %s (code: %d)",
                      strerror(errno), errno);
  if (pipe(stdout_pipe) == -1)
    return luaL_error(L, "Failed creating stdout pipe: %s (code: %d)",
                      strerror(errno), errno);

  syslog(LOG_DEBUG, "Forking");

  if ((childpid = fork()) == -1) {
    return luaL_error(L, "Failed forking: %s (code: %d)", strerror(errno),
                      errno);
  }

  if (childpid == 0) {
    close(stdin_pipe[1]);
    close(stdout_pipe[0]);

    if (dup2(stdin_pipe[0], 0) == -1) {
      fprintf(stderr, "Failed duplicating stdin pipe: %s (code: %d)",
              strerror(errno), errno);
      exit(1);
    }
    if (dup2(stdout_pipe[1], 1) == -1) {
      fprintf(stderr, "Failed duplicating stdout pipe: %s (code: %d)",
              strerror(errno), errno);
      exit(1);
    }

    if (execvp(cmd, argv) == -1) {
      fprintf(stderr, "Failed executing %s: %s (code: %d)", cmd,
              strerror(errno), errno);
      exit(1);
    }
  }

  syslog(LOG_DEBUG, "Started child process %d", childpid);

  close(stdin_pipe[0]);
  close(stdout_pipe[1]);

  if (inp_size) {
    write(stdin_pipe[1], inp, inp_size);
    close(stdin_pipe[1]);
  }

  syslog(LOG_DEBUG, "Reading from stdout");
  int output_size = 0;
  unsigned char *output = read_fd(L, stdout_pipe[0], &output_size);
  if (output == NULL)
    return lua_error(L);

  int status;
  if (waitpid(childpid, &status, 0) == -1)
    return luaL_error(L, "Process failed: %s (code: %d)", strerror(errno),
                      errno);

  syslog(LOG_DEBUG, "Child process exited %d", status);

  if (status)
    return luaL_error(L, "Process exited with status %d", status);

  lua_pushlstring(L, (const char *)output, output_size);
  lua_pushinteger(L, output_size);

  return 2;
}

int http_request(lua_State *L) {
  CURL *curl;
  CURLcode res = CURLE_OK;
  struct curl_slist *headers = 0;

  const char *method = luaL_checkstring(L, 1);
  const char *url = luaL_checkstring(L, 2);

  syslog(LOG_DEBUG, "Sending %s request to %s", method, url);

  curl = curl_easy_init();
  if (!curl) {
    lua_pushfstring(L, "Failed creating request: %s (code: %d)",
                    strerror(errno), errno);
    res = CURLE_OBSOLETE;
    goto cleanup;
  }

  curl_easy_setopt(curl, CURLOPT_URL, url);
  if (strcmp(method, "GET") == 0)
    curl_easy_setopt(curl, CURLOPT_HTTPGET, 1L);
  else if (strcmp(method, "POST") == 0)
    curl_easy_setopt(curl, CURLOPT_POST, 1L);
  else if (strcmp(method, "PUT") == 0)
    curl_easy_setopt(curl, CURLOPT_PUT, 1L);
  else if (strcmp(method, "HEAD") == 0)
    curl_easy_setopt(curl, CURLOPT_NOBODY, 1L);
  else
    curl_easy_setopt(curl, CURLOPT_CUSTOMREQUEST, (char *)method);

  if (lua_gettop(L) > 2) {
    int top_idx = lua_gettop(L) + 1;

    {
      lua_pushstring(L, "headers");
      int valtype = lua_gettable(L, 3);
      if (valtype != LUA_TNIL) {
        if (valtype != LUA_TTABLE)
          return luaL_error(L, "The 'headers' option must contain a list");

        int num_headers = luaL_len(L, top_idx);
        for (int i = 1; i <= num_headers; i++) {
          lua_pushinteger(L, i);
          lua_gettable(L, top_idx);
          headers = curl_slist_append(headers, lua_tostring(L, -1));
        }
        curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);
        lua_pop(L, 1);
      }
    }

    {
      lua_pushstring(L, "body");
      int valtype = lua_gettable(L, 3);
      if (valtype != LUA_TNIL) {
        if (valtype != LUA_TSTRING)
          return luaL_error(L, "The 'body' option must contain a string");

        curl_easy_setopt(curl, CURLOPT_POSTFIELDS, lua_tostring(L, top_idx));
        lua_pop(L, 1);
      }
    }

    {
      lua_pushstring(L, "follow_redirects");
      int valtype = lua_gettable(L, 3);
      if (valtype != LUA_TNIL) {
        if (valtype != LUA_TBOOLEAN)
          return luaL_error(
              L, "The 'follow_redirects' option must contain a boolean");

        if (lua_tointeger(L, -1) == 1)
          curl_easy_setopt(curl, CURLOPT_FOLLOWLOCATION, 1L);

        lua_pop(L, 1);
      }
    }
  }

  curl_easy_setopt(curl, CURLOPT_ACCEPT_ENCODING, "");

  res = curl_easy_perform(curl);
  if (res != CURLE_OK) {
    lua_pushfstring(L, "Failed sending request: %s", curl_easy_strerror(res));
    goto cleanup;
  }

  lua_newtable(L);

  long status;
  if (curl_easy_getinfo(curl, CURLINFO_RESPONSE_CODE, &status) == CURLE_OK)
    pushtableint(L, "status", (int)status);

  char *content_type;
  if (curl_easy_getinfo(curl, CURLINFO_CONTENT_TYPE, &content_type) == CURLE_OK)
    pushtablestring(L, "content_type", content_type);

cleanup:
  curl_slist_free_all(headers);
  curl_easy_cleanup(curl);
  if (res != CURLE_OK)
    return lua_error(L);

  return 1;
}
